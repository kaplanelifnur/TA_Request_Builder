[req-command]
syntax = req (url=<string>)? (identity=<string>)? (realm=<string>)?
shortdesc = Makes HTTP requests based on event data.
description = This command makes HTTP requests using the python requests library. \
    It expects request parameters to be present in the event data as fields. \
    \
    ARGUMENTS: \
    * url: The target URL. Can also be provided as a field 'url'. \
    * identity: Splunk Storage Password username. \
    * realm: Splunk Storage Password realm. \
    \
    REQUIRED FIELDS: \
    * url: Target URL (if not provided as argument). \
    \
    OPTIONAL FIELDS: \
    * method: HTTP method (GET, POST, etc.). Defaults to "GET". \
    * headers: JSON string of HTTP headers. \
    * data: Request body/payload. \
    * cookies: JSON string of cookies. \
    * verify: Boolean/String to control SSL verification. Defaults to "true". \
    * timeout: Integer timeout in seconds. Defaults to 15. \
    \
    OUTPUT: \
    * status_code: HTTP status code. \
    * response: Response body. \
    * response_headers: JSON string of response headers.
usage = public
example1 = | makeresults | eval url="https://httpbin.org/get", method="GET" | req
comment1 = Simple GET request
example2 = | makeresults | eval url="https://httpbin.org/post", method="POST", data="{\"key\":\"value\"}", headers="{\"Content-Type\": \"application/json\"}" | req
comment2 = POST request with JSON data
related = curl
tags = req
maintainer = Elif
 
[req:identity]
syntax = identity=<string>
description = The username part of the credential stored in Splunk's Storage Passwords to use for authentication. Must be paired with 'realm'.
 
[req:realm]
syntax = realm=<string>
description = The realm part of the credential stored in Splunk's Storage Passwords to use for authentication. Must be paired with 'identity'.
 
[req:url]
syntax = url=<string>
description = The target URL. If not provided as an argument, it must be present in the event data as a field named 'url'.
 